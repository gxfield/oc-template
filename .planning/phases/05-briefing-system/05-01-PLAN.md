---
phase: 05-briefing-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [TOOLS.md]
autonomous: true

must_haves:
  truths:
    - "User can say 'briefing' or 'status' and get a combined household summary"
    - "Briefing output includes today's calendar events, pending todos, shopping list, tonight's meal, and bills due in next 7 days"
    - "Briefing output is formatted for Telegram (no markdown tables, uses emoji and bullet lists)"
    - "TOOLS.md documents the briefing command with trigger phrases, parsing rules, and exact output examples"
  artifacts:
    - path: "TOOLS.md"
      provides: "Briefing command handler with full documentation"
      contains: "### Briefing Output Sections"
  key_links:
    - from: "TOOLS.md Briefing section"
      to: "household/bills.md"
      via: "bills due in next 7 days query"
    - from: "TOOLS.md Briefing section"
      to: "all household data sources"
      via: "calendar CLI + markdown file reads"
---

<objective>
Expand the existing Briefing stub in TOOLS.md into a full command handler with trigger phrases, data assembly instructions, output formatting rules, and Telegram-friendly output examples.

Purpose: Cheap LLMs need unambiguous instructions to assemble a multi-source briefing without missing data sources, using wrong commands, or outputting markdown tables in Telegram.
Output: Fully documented Briefing section in TOOLS.md
</objective>

<execution_context>
@/Users/greg/.claude/get-shit-done/workflows/execute-plan.md
@/Users/greg/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@TOOLS.md
@QUICKSTART.md
@household/bills.md
@household/todos.md
@household/shopping.md
@household/meals/this-week.md
@household/notes.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand Briefing section in TOOLS.md</name>
  <files>TOOLS.md</files>
  <action>
Replace the existing stub Briefing section in TOOLS.md (lines 192-196, under "### Briefing") with a comprehensive Briefing command handler section. Follow the same documentation pattern used by Quick Capture and Meal Planning sections.

The expanded Briefing section should contain:

**1. Trigger Phrase Table:**

| Trigger Pattern | Action |
|---|---|
| "briefing", "morning briefing", "evening briefing" | Full household briefing |
| "status", "house status", "household status" | Full household briefing |
| "what's going on", "catch me up", "what did I miss" | Full household briefing |

**2. Data Assembly Steps (in this order):**

The agent must gather data from these 5 sources in order:

1. **Calendar:** Run `node calendar/calendar.js today` to get today's events
2. **Todos:** Read `household/todos.md`, extract incomplete items (lines with `- [ ]`)
3. **Shopping:** Read `household/shopping.md`, extract all items
4. **Meals:** Get today's day name from `node calendar/calendar.js now`, read `household/meals/this-week.md`, find matching day line
5. **Bills:** Read `household/bills.md`, extract unpaid bills (`- [ ]` lines), filter to those with due date within next 7 days (compare to today's Pacific date from `node calendar/calendar.js now`)

**3. Output Format Template (Telegram-friendly):**

The output must use emoji headers and bullet lists -- NO markdown tables. Show the template:

```
Here's your briefing for {Day, Month Date}:

üìÖ Calendar
{If events: bullet list of events with times}
{If no events: "Nothing on the calendar today!"}

‚úÖ Todos ({count} pending)
{Bullet list of incomplete items}
{If none: "All clear!"}

üõí Shopping List ({count} items)
{Bullet list of items}
{If none: "Shopping list is empty!"}

üçΩÔ∏è Tonight's Dinner
{Meal from this-week.md}
{If "No plan": "No dinner planned. Want me to set something?"}

üí∞ Bills Due Soon
{Bullet list of unpaid bills due within 7 days with amount and due date}
{If none: "No bills due this week!"}
```

**4. Input/Output Examples:**

Include 2 examples:

Example 1 - Full briefing with data:
- Input: "morning briefing"
- Action: Run calendar today, read todos/shopping/meals/bills, assemble output
- Response: Show filled template with realistic data

Example 2 - Briefing with empty sections:
- Input: "status"
- Action: Same data gathering
- Response: Show template with "Nothing on the calendar today!", "All clear!", etc.

**5. DO / DO NOT Table:**

| DO | DO NOT | WHY |
|---|---|---|
| Use `node calendar/calendar.js today` for calendar events | Use `list` or `upcoming` | `today` gives correct Pacific day boundaries |
| Get today's date from `node calendar/calendar.js now` for bill date comparison | Use `date` command | System clock is UTC |
| Use bullet lists with emoji headers | Use markdown tables | Telegram doesn't render markdown tables |
| Show all 5 sections even if empty | Skip empty sections | User expects consistent format |
| Show bill amounts and due dates | Show only bill names | User needs to know how much and when |

**6. Edge Cases:**

- "morning briefing" vs "evening briefing": Same content (no time-based variation for v1)
- Bills due today: Include in "Bills Due Soon" (today counts as within 7 days)
- No data in any source: Still show all 5 section headers with empty-state messages

Place the expanded Briefing section at the same location it currently occupies (between Notes parsing examples and Help, under the "### Briefing" header in the Telegram Command Handlers area).
  </action>
  <verify>
Verify:
1. TOOLS.md contains expanded Briefing section with trigger phrase table
2. Section includes data assembly steps referencing all 5 sources
3. Output format template uses emoji headers and bullet lists (no tables in output)
4. DO/DO NOT table present
5. At least 2 input/output examples
6. Edge cases documented
7. All calendar references use `node calendar/calendar.js` (not `node calendar.js`)
8. Bills query references `node calendar/calendar.js now` for date comparison
  </verify>
  <done>TOOLS.md Briefing section is fully documented with trigger phrases, data assembly steps, Telegram-friendly output template, examples, DO/DO NOT table, and edge cases -- matching the documentation depth of Quick Capture and Meal Planning sections.</done>
</task>

</tasks>

<verification>
1. Read TOOLS.md and confirm Briefing section has: trigger table, data assembly steps, output template, 2+ examples, DO/DO NOT table, edge cases
2. Confirm output template uses emoji headers and bullet lists (no markdown tables in output)
3. Confirm all 5 data sources referenced: calendar, todos, shopping, meals, bills
4. Confirm bills query includes 7-day window logic
5. Confirm all CLI references use correct path (calendar/calendar.js)
</verification>

<success_criteria>
- TOOLS.md Briefing section is comprehensive (comparable to Quick Capture and Meal Planning sections)
- Trigger phrases documented: "briefing", "status", "house status", "what's going on", etc.
- Output template is Telegram-friendly (emoji headers, bullet lists, no tables)
- All 5 data sources have assembly instructions with correct commands/paths
- Bills due within 7 days are included with amount and due date
- DO/DO NOT table prevents common LLM mistakes
</success_criteria>

<output>
After completion, create `.planning/phases/05-briefing-system/05-01-SUMMARY.md`
</output>
